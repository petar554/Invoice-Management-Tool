# üìã Sistem Klasifikacije Dokumenata - Logika Procesa

**Verzija:** 1.0  
**Datum:** 16. Oktobar 2025

---

## Svrha Dokumenta

Defini≈°e logiku automatske klasifikacije dokumenata (fakture, ugovori, izvodi) koji sti≈æu putem email-a u Invoice Management Tool.

---

## Registracija Organizacije i Klijenata

### 1. Organizacija (Raƒçunovodstvena Firma) se Registruje

Pri registraciji unosi:

- **PIB organizacije** - Koristi se za prepoznavanje dokumenata dje je raƒçunovodstvena firma primalac
- Osnovne podatke (naziv, email, adresa)

### 2. Organizacija Dodaje Klijente

Za svakog klijenta unosi:

- **PIB klijenta** (obavezno) - Kljuƒçan za OCR identifikaciju
- **Email klijenta** (obavezno) - Koristi se kao fallback identifikacija
- **Brojevi raƒçuna** (obavezno za izvode) - Svi raƒçuni klijenta:
  - Lokalni format (npr. `540-000000000787106`)
  - IBAN format (npr. `ME25520042000000529729`)
- Ostale podatke (naziv, telefon, grad, industrija)

**Va≈æno:** Email domen klijenta slu≈æi kao alternativni naƒçin identifikacije kada PIB nije dostupan na dokumentu (npr. fiziƒçka lica, reprezentacija).

---

## Proces Klasifikacije Dokumenta

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   DOKUMENT STIGAO PUTEM EMAIL-A          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  KORAK 1: ODREƒêIVANJE TIPA DOKUMENTA     ‚îÇ
‚îÇ  ‚Ä¢ OCR skeniranje cijelog dokumenta      ‚îÇ
‚îÇ  ‚Ä¢ Pretraga kljuƒçnih rijeƒçi              ‚îÇ
‚îÇ  ‚Ä¢ Confidence scoring                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                 ‚îÇ
    ‚úÖ Confidence      ‚ùå Confidence
       >= 80%             < 80%
          ‚îÇ                 ‚îÇ
          ‚îÇ                 ‚ñº
          ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ         ‚îÇ MANUAL REVIEW    ‚îÇ
          ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  KORAK 2: IDENTIFIKACIJA KLIJENTA        ‚îÇ
‚îÇ  ‚Ä¢ Za FAKTURU: PIB izdavaoca/primaoca    ‚îÇ
‚îÇ  ‚Ä¢ Za IZVOD: Broj raƒçuna ili PIB         ‚îÇ
‚îÇ  ‚Ä¢ Za UGOVOR: PIB                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                 ‚îÇ
    ‚úÖ Klijent          ‚ùå Klijent
    Identifikovan       Nije Pronaƒëen
          ‚îÇ                 ‚îÇ
          ‚îÇ                 ‚ñº
          ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ         ‚îÇ KORAK 3:         ‚îÇ
          ‚îÇ         ‚îÇ Email Fallback   ‚îÇ
          ‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                  ‚îÇ
          ‚îÇ           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ           ‚îÇ            ‚îÇ
          ‚îÇ        ‚úÖ Email    ‚ùå Email
          ‚îÇ        Match       Ne Match
          ‚îÇ           ‚îÇ            ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
                           ‚îÇ       ‚ñº
                           ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                           ‚îÇ  ‚îÇMANUAL REVIEW ‚îÇ
                           ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ ‚úÖ KLASIFIKACIJA     ‚îÇ
                ‚îÇ    ZAVR≈†ENA          ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Detaljna Logika po Koracima

### **KORAK 1: Odreƒëivanje Tipa Dokumenta**

**Sistem otvara dokument i OCR skenira CIJELI dokument paralelno tra≈æeƒái kljuƒçne rijeƒçi za SVE tipove.**

---

#### **A) FAKTURA - Confidence Scoring**

**Pravilo:**

```
Base Confidence: 60%
+ PIB izdavaoca I PIB primaoca pronaƒëeni: +10% ‚Üí 70%
+ Klijent identifikovan (izdavalac/primalac odreƒëen): +10% ‚Üí 80%+
```

**Proces:**

1. **OCR tra≈æi kljuƒçne rijeƒçi** (u gornjih 30% dokumenta):

   - `"FAKTURA"`, `"INVOICE"`, `"RAƒåUN"`, `"BROJ FAKTURE"`

2. **AKO pronaƒëeno:**

   - Postavi tip: **FAKTURA**
   - Base confidence: **60%**

3. **Ekstraktuj PIB-ove:**

   - OCR tra≈æi sve nizove od 8 cifara
   - Za svaki PIB analiziraj okolni tekst (¬±200 karaktera)
   - Pretraga kljuƒçnih rijeƒçi:
     - `"Izdavalac", "Dobavljaƒç", "Prodavac"` ‚Üí PIB izdavaoca
     - `"Primalac", "Kupac", "Naruƒçilac"` ‚Üí PIB primaoca
   - Ako se pojavi kljuƒçna rijeƒç fakture (na primjer: 'PDV') ‚â• 3 od ovih, klasifikovati dokument kao fakturu sa visokim povjerenjem (> 80%).

4. **AKO pronaƒëena 2 PIB-a:**

   - Confidence: **70%**

5. **Uporedi PIB organizacije sa PIB-ovima na fakturi:**

   - **PIB org = PIB primaoca** ‚Üí **ULAZNA FAKTURA** (klijent = izdavalac)
   - **PIB org = PIB izdavaoca** ‚Üí **IZLAZNA FAKTURA** (klijent = primalac)

6. **AKO klijent identifikovan:**
   - Confidence: **80%+**
   - ‚Üí Prelazi na KORAK 2

**Ishod:**

- **Confidence >= 80%** ‚Üí Prelazi na KORAK 2
- **Confidence < 80%** ‚Üí **MANUAL REVIEW**

---

#### **B) IZVOD - Confidence Scoring**

**Pravilo:**

```
Base Confidence: 75%
+ Podaci o banci u prvom dijelu: +5% ‚Üí 80%
+ Rijeƒç "BANKA" pronaƒëena: +5% ‚Üí 85%
+ Iskljuƒçivo jedan PIB: +2% ‚Üí 87%
```

**Proces:**

1. **OCR tra≈æi kljuƒçne rijeƒçi** (u gornjih 20% dokumenta):

   - `"IZVOD"`, `"IZVOD PROMETA"`, `"IZVOD PO RAƒåUNU"`
   - `"STATEMENT"`, `"BANK STATEMENT"`, `"ACCOUNT STATEMENT"`
   - Ako se pojavi kljuƒçna rijeƒç izvoda (na primjer: 'prethodno stanje', 'novo stanje') ‚â• 3 od ovih, klasifikovati dokument kao IZVOD sa visokim povjerenjem (> 80%).

2. **AKO pronaƒëeno:**

   - Postavi tip: **IZVOD**
   - Base confidence: **75%**

3. **Provjera podataka o banci** (u prvom dijelu - gornjih 20%):

   - OCR tra≈æi nazive banaka:
     - `"ERSTE BANK"`, `"CKB"`, `"HIPOTEKARNA BANKA"`, itd.
   - **AKO pronaƒëeno:**
     - Confidence: **80%**

4. **Pretraga rijeƒçi "BANKA":**

   - **AKO pronaƒëeno:**
     - Confidence: **85%**

5. **Brojanje PIB-ova:**

   - OCR ekstraktuje sve PIB-ove
   - **AKO taƒçno 1 PIB:**
     - Confidence: **87%**

6. **Ekstraktuj broj raƒçuna:**
   - Format: `XXX-XXXXXXXXXXXX` ili `MEXXXXXXXXXXXXXXXXXX`

**Ishod:**

- **Confidence >= 80%** ‚Üí Prelazi na KORAK 2
- **Confidence < 80%** ‚Üí **MANUAL REVIEW**

---

#### **C) UGOVOR - Confidence Scoring**

**Pravilo:**

```
Base Confidence: 90%
+ PIB pronaƒëen: +5% ‚Üí 95%
```

**Proces:**

1. **OCR tra≈æi kljuƒçne rijeƒçi:**

   - `"UGOVOR"`, `"CONTRACT"`, `"UGOVORNE STRANKE"`

2. **AKO pronaƒëeno:**

   - Postavi tip: **UGOVOR**
   - Base confidence: **90%**

3. **Ekstraktuj PIB:**
   - **AKO pronaƒëen:**
     - Confidence: **95%**

**Ishod:**

- **Confidence >= 80%** ‚Üí Prelazi na KORAK 2

---

### **KORAK 2: Identifikacija Klijenta**

**Aktivira se SAMO ako tip dokumenta je odreƒëen sa confidence >= 80%.**

---

#### **A) Za FAKTURU:**

**Proces:**

1. Klijent je veƒá identifikovan u KORAKU 1 (tokom confidence scoring-a)
2. Pretra≈æi bazu po PIB-u klijenta:
   - Za ULAZNU: PIB izdavaoca
   - Za IZLAZNU: PIB primaoca

**Ishodi:**

- **Klijent pronaƒëen u bazi** ‚Üí **KLASIFIKACIJA ZAVR≈†ENA**
- **Klijent nije u bazi** ‚Üí Prelazi na KORAK 3

---

#### **B) Za IZVOD:**

**Prioritet metoda:**

1. **Broj raƒçuna** (najsigurniji):

   - Pretra≈æi bazu po broju raƒçuna (lokalni ili IBAN)

2. **PIB** (ako postoji):

   - Pretra≈æi bazu po PIB-u

3. **Naziv klijenta** (najmanje pouzdan):
   - Fuzzy matching u bazi

**Ishodi:**

- **Klijent pronaƒëen** ‚Üí **KLASIFIKACIJA ZAVR≈†ENA**
- **Klijent nije pronaƒëen** ‚Üí Prelazi na KORAK 3

---

#### **C) Za UGOVOR:**

**Proces:**

1. Pretra≈æi bazu po PIB-u

**Ishodi:**

- **Klijent pronaƒëen** ‚Üí **KLASIFIKACIJA ZAVR≈†ENA**
- **Klijent nije pronaƒëen** ‚Üí Prelazi na KORAK 3

---

### **KORAK 3: Email Fallback**

**Aktivira se ako klijent nije pronaƒëen u KORAKU 2.**

**Proces:**

1. Proveri email po≈°iljaoca
2. Izvuci domen (npr. `@restoran-montenegro.me`)
3. Pretra≈æi bazu klijenata po email domenu

**Ishodi:**

- **Email domen prepoznat** ‚Üí **KLASIFIKACIJA ZAVR≈†ENA**
- **Email domen nije prepoznat** ‚Üí **MANUAL REVIEW**

---

## Manual Review - Nedovr≈°eni Folderi

### Razlozi za Manual Review

1. **Klijent nije identifikovan** (ni po PIB-u, ni po email-u)
2. **Tip dokumenta nije odreƒëen** u KORAKU 1 (niska pouzdanost OCR)

### Struktura Nedovr≈°enog Foldera

**Format naziva:**

```
{email_posiljaoca}_{PIB_ako_postoji}_{naziv_firme_ako_postoji}
```

**Primjeri:**

- `marko@gmail.com_PIB_02987654_Restoran_Montenegro`
- `unknown@company.me_NO_PIB`
- `fizicko.lice@gmail.com_PIB_UNKNOWN`

### Vizuelne Oznake

- **≈Ωuta boja** foldera (warning status)
- **Crvena boja** za urgentne sluƒçajeve
- **Aktivne notifikacije** za raƒçunovoƒëu
- **Highlight** (border, animacija)

---

## Testni Scenariji

### **Scenario 1: Uspe≈°na Klasifikacija Izvoda (Broj Raƒçuna Match)**

**Setup:**

- Klijent: "Restoran Montenegro DOO" (PIB: 02987654, Raƒçun: 540-000000000787106)
- Dokument: Izvod iz banke u PDF formatu

**Tok:**

1. Email stigne sa `banka@erste.me`
2. OCR prepoznaje kljuƒçne rijeƒçi: "IZVOD PROMETA" + "ERSTE BANK"
3. Tip dokumenta: **IZVOD**
4. OCR ekstraktuje broj raƒçuna: `540-000000000787106`
5. Sistem pronalazi klijenta u bazi po broju raƒçuna
6. Dokument se klasifikuje

**Rezultat:**

```
   Tip: IZVOD
   Klijent: Restoran Montenegro DOO (Raƒçun match)
   Folder: /org_123/Restoran_Montenegro/Izvodi/ime_dokumenta_vrijeme
   Status: KLASIFIKOVAN
```

---

### **Scenario 2: Uspe≈°na Klasifikacija Fakture (PIB Match)**

**Setup:**

- Klijent: "IT Company DOO" (PIB: 02333444, Email: office@itcompany.me)
- Dokument: Faktura u PDF formatu

**Tok:**

1. Email stigne sa `kontakt@gmail.com` (privatni email)
2. OCR prepoznaje kljuƒçnu rijeƒç: "FAKTURA"
3. Tip dokumenta: **FAKTURA**
4. OCR ekstraktuje PIB: `02333444`
5. Sistem pronalazi klijenta u bazi
6. OCR odreƒëuje tip: "Ulazna Faktura"
7. Dokument se klasifikuje

**Rezultat:**

```
   Tip: ULAZNA FAKTURA
   Klijent: IT Company DOO (PIB match)
   Folder: /org_123/IT_Company/Ulazne_Fakture/ime_dokumenta_vrijeme
   Status: KLASIFIKOVAN
```

---

### **Scenario 3: Uspe≈°na Klasifikacija (Email Fallback)**

**Setup:**

- Klijent: "Cafe Bar XYZ" (PIB: 02444555, Email: office@cafexyz.me)
- Dokument: Raƒçun bez PIB-a (reprezentacija)

**Tok:**

1. Email stigne sa `marko@cafexyz.me`
2. OCR prepoznaje kljuƒçnu rijeƒç: "RAƒåUN"
3. Tip dokumenta: **FAKTURA**
4. OCR ne pronalazi PIB na dokumentu
5. Sistem prepoznaje email domen `@cafexyz.me`
6. Sistem pronalazi klijenta u bazi
7. Dokument se klasifikuje

**Rezultat:**

```
   PIB nije pronaƒëen na dokumentu
   Tip: FAKTURA
   Klijent: Cafe Bar XYZ (Email match)
   Folder: /org_123/Cafe_Bar_XYZ/Ulazne_Fakture/ime_dokumenta_vrijeme
   Status: KLASIFIKOVAN
```

---

### **Scenario 4: Manual Review - Klijent Nepoznat** ‚ö†Ô∏è

**Setup:**

- Email: `unknown@newcompany.me` (nije u bazi)
- Dokument: Faktura sa PIB-om `02777888` (nije u bazi)

**Tok:**

1. Email stigne sa `unknown@newcompany.me`
2. OCR prepoznaje tip: "FAKTURA"
3. OCR ekstraktuje PIB: `02777888`
4. PIB nije pronaƒëen u bazi
5. Email domen nije pronaƒëen u bazi
6. Sistem kreira nedovr≈°en folder

**Rezultat:**

```
   Tip: FAKTURA
   PIB 02777888 nije u bazi
   Email unknown@newcompany.me nije u bazi
   MANUAL REVIEW potreban
   Folder: /manual_review/unknown@newcompany.me-02777888/ime_dokumenta
   Notifikacija poslata raƒçunovodstvu i pojavljuje se u aplikaciji
   Status: PENDING_REVIEW
```

---

### **Scenario 5: Manual Review - Tip Dokumenta Nepoznat** ‚ö†Ô∏è

**Setup:**

- Klijent: "Restoran Super DOO" (postoji u bazi)
- Dokument: Nestandarni dokument (OCR ne prepoznaje tip)

**Tok:**

1. Email stigne sa `office@super.me`
2. OCR ekstraktuje PIB: `02555666`
3. Sistem pronalazi klijenta
4. OCR ne mo≈æe prepoznati tip dokumenta (nema kljuƒçnih reƒçi)
5. AI fallback takoƒëe nije siguran (< 70% pouzdanost)
6. Sistem kreira nedovr≈°en folder

**Rezultat:**

```
   Klijent: Restoran Super DOO (PIB match)
   Tip dokumenta nije prepoznat (confidence: 45%)
   MANUAL REVIEW potreban
   Folder: /manual_review/office@super.me-02555666/ime_dokumenta
   Notifikacija poslata raƒçunovodstvu i pojavljuje se u aplikaciji
   Status: PENDING_REVIEW
```

---

## Specijalni Sluƒçajevi

### **1. Izvodi**

**Karakteristike:**

- Naziv dokumenta je jasan: "IZVOD", "BANK STATEMENT"
- Mogu sadr≈æati PIB, ali to nije garantovano
- Uvijek sadr≈æe broj raƒçuna (lokalni ili IBAN format)

**Proces identifikacije:**

1. **Tip dokumenta:** OCR prepoznaje kljuƒçne rijeƒçi ("IZVOD" + "BANKA")
2. **Klijent:**
   - Prioritet 1: PIB (ako postoji)
   - Prioritet 2: Broj raƒçuna (najsigurniji metod)
   - Prioritet 3: Naziv klijenta (fuzzy matching)
3. **Rezultat:** Retko zahtevaju manual review

### **2. Ugovori**

**Karakteristike:**

- Uvek sadr≈æe PIB
- Naziv dokumenta je jasan: "UGOVOR", "CONTRACT"

**Proces:**

- Direktna klasifikacija preko PIB-a (KORAK 1)
- Tip prepoznat sa visokom pouzdano≈°ƒáu
- Retko zahtevaju manual review

---

### **3. Fiziƒçka Lica (Reprezentacija)**

**Karakteristike:**

- Raƒçuni ƒçesto nemaju PIB
- ≈†alju se sa privatnih email-ova

**Proces:**

- PIB nije pronaƒëen ‚Üí Email fallback (KORAK 2)
- Ako email nije u bazi ‚Üí Manual review
- **Preporuka:** Dodati email fiziƒçkog lica kao dodatni email klijenta

---

## Rezime Logike

### **Flow Klasifikacije:**

```
DOKUMENT ‚Üí KORAK 1 (Tip dokumenta + Confidence)
           ‚Üì
    Confidence >= 80%?
    ‚úÖ DA ‚Üí KORAK 2 (Identifikacija klijenta)
            ‚Üì
        Klijent pronaƒëen?
        ‚úÖ DA ‚Üí ZAVR≈†ENO
        ‚ùå NE ‚Üí KORAK 3 (Email fallback)
                ‚Üì
            Email match?
            ‚úÖ DA ‚Üí ZAVR≈†ENO
            ‚ùå NE ‚Üí MANUAL REVIEW

    ‚ùå NE ‚Üí MANUAL REVIEW
```

### **Confidence Thresholds:**

| Tip Dokumenta | Base | Max Confidence                | Threshold |
| ------------- | ---- | ----------------------------- | --------- |
| **FAKTURA**   | 60%  | 80%+ (sa PIB-ovima + klijent) | 80%       |
| **IZVOD**     | 75%  | 87% (sa bankom + PIB)         | 80%       |
| **UGOVOR**    | 90%  | 95% (sa PIB-om)               | 80%       |

**Pravilo:** Ako confidence < 80% ‚Üí Automatski MANUAL REVIEW

---

### **Prioritet Identifikacije Klijenta:**

| Tip         | Metod 1                | Metod 2     | Metod 3        |
| ----------- | ---------------------- | ----------- | -------------- |
| **FAKTURA** | PIB izdavaoca/primaoca | Email domen | -              |
| **IZVOD**   | Broj raƒçuna            | PIB         | Naziv klijenta |
| **UGOVOR**  | PIB                    | Email domen | -              |

**Cilj:** Minimizovati manual review (<10% sluƒçajeva) uz confidence >= 80% za tip dokumenta.

---
